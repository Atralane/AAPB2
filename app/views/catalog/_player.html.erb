<% content_for(:head) do %>
  <link href="http://vjs.zencdn.net/5.11.7/video-js.css" rel="stylesheet">
  <script src="http://vjs.zencdn.net/5.11.7/video.js"></script>
  <!-- video-js support for IE 8 -->
  <script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
  <!-- Need VideoJS for our player.js file -->
  <script src="/assets/player.js"></script>
<% end %>

<div class="row">
  <div class="col-sm-12 col-md-8 player col-md-offset-2">
    <%=
      @pbcore.media_srcs.map do |media_src|
        media = @pbcore.video? ? 'video' : 'audio'
        content_tag(media,
                    controls: true,
                    "class" => "video-js video-js-fix-large",
                    "id" => "player_media",
                    oncontextmenu: 'return false;',
                    preload: 'auto',
                    width: @pbcore.player_specs[0],
                    height: @pbcore.player_specs[1],
                    crossorigin: 'with-credentials',
                    :"data-setup" => '{}',
                    poster: @pbcore.img_src) do %>

          <source src="<%= media_src %>" type='<%= @pbcore.video? ? 'video/mp4' : 'audio/mp3' %>' />

          <% if @pbcore.captions_src %>
            <track kind="captions" src="/captions/<%= @pbcore.id %>.vtt" srclang="en" label="English" default="default" />
          <% end %>
          <%
        end
      end.join().html_safe()
    %>
    <% Exhibit.find_top_by_item_id(@pbcore.id).each do |exhibit| %>
      <% exhibit_caption = "This record is featured in “#{exhibit.title}.”" %>
      <a href="/exhibits/<%= exhibit.path %>" class="btn-featured-record" title="<%= exhibit_caption %>" id="exhibit-banner">
        <span class="glyphicon glyphicon-star"></span>
        <strong><%= exhibit_caption %></strong>
      </a>
    <% end %>
  </div>
  <div class="col-sm-12 col-md-2 transcript-div">
    <% if @show_transcript %>
      <div class="transcript-header">
        <p>Transcript</p>
        <div class="input-group input-group-sm transcript-search" role="search">
          <label for="q" class="sr-only">Search Transcript...</label>
          <input aria-label="Search" class="search_q q form-control transcript-search-input" id="transcript-q" name="q" placeholder="Search..." type="search" />

          <span class="input-group-btn transcript-search-btn-group">
            <button type="submit" class="btn btn-primary search-btn transcript-search-btn" id="transcript-search-btn">
              <span class="submit-search-text sr-only">Search</span>
              <span class="glyphicon glyphicon-search"></span>
            </button>
          </span>
        </div>
        <div class="show-transcript transcript-slide" style="cursor: pointer;">
          Show<div class="transcript-circle">+</div>
        </div>
      </div>
      <div class="transcript-view transcript-view-small">
        <div id="transcript", class="transcript-frame plain">
          <%= raw @transcript_html %>
        </div>
    <% else %>
      <div class="transcript-header">
        <p>Transcript</p>
        <div class="no-transcript">
          Not Available
        </div>
      </div>
    <% end %>
    </div>
  </div>
</div>
